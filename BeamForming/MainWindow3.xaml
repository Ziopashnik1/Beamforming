<Window x:Class="BeamForming.MainWindow3"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008" mc:Ignorable="d"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:l="clr-namespace:BeamForming"
        xmlns:b="clr-namespace:BeamService;assembly=BeamService"
        xmlns:xc="http://schemas.xceed.com/wpf/xaml/toolkit"
        Title="MainWindow3" 
        Height="450" Width="800">
    <Window.DataContext>
        <l:MainWindow3ViewModel/>
    </Window.DataContext>
    <Window.Resources>
        <Style x:Key="ParameterGroup" TargetType="{x:Type GroupBox}">
            <Setter Property="BorderThickness" Value="0"/>
        </Style>
    </Window.Resources>
    <DockPanel>
        <StatusBar DockPanel.Dock="Bottom"></StatusBar>
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="1*"/>
                <ColumnDefinition Width="2*"/>
            </Grid.ColumnDefinitions>
            <DockPanel Grid.Column="0">
                <GroupBox DockPanel.Dock="Bottom" Header="Источник">
                    <GroupBox.Resources>
                        <DataTemplate DataType="{x:Type b:SinSignal}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Grid.Row="0" Text="Амплитуда"/>
                                <xc:DoubleUpDown Grid.Column="1" Grid.Row="0" Value="{Binding Amplitude}"/>
                                <TextBlock Grid.Column="0" Grid.Row="1" Text="Частота"/>
                                <xc:DoubleUpDown Grid.Column="1" Grid.Row="1" Value="{Binding Frequency}"/>
                                <TextBlock Grid.Column="0" Grid.Row="2" Text="Фаза"/>
                                <xc:DoubleUpDown Grid.Column="1" Grid.Row="2" Value="{Binding Phase}"/>
                            </Grid>
                        </DataTemplate>

                        <DataTemplate DataType="{x:Type b:SpaceSignal}">
                            <StackPanel>
                                <GroupBox Header="Угол падения" Style="{StaticResource ParameterGroup}">
                                    <xc:DoubleUpDown Value="{Binding Thetta}"/>
                                </GroupBox>
                                <GroupBox Header="Сигнал" Style="{StaticResource ParameterGroup}">
                                    <ContentControl Content="{Binding Signal}"/>
                                </GroupBox>
                            </StackPanel>
                        </DataTemplate>
                    </GroupBox.Resources>
                    <ContentControl Content="{Binding SelectedItem, ElementName=SourcesList}"/>
                </GroupBox>
                <GroupBox Header="Источники">
                    <DockPanel>
                        <DockPanel.Resources>
                            <DataTemplate DataType="{x:Type b:SinSignal}">
                                <TextBlock>
                                    <TextBlock Text="{Binding Amplitude}"/>
                                    * Sin(2*pi*(<TextBlock Text="{Binding Frequency}"/>*t + <TextBlock Text="{Binding Phase}"/>))
                                </TextBlock>
                            </DataTemplate>

                            <DataTemplate DataType="{x:Type b:CosSignal}">
                                <TextBlock>
                                    <TextBlock Text="{Binding Amplitude}"/>
                                    * Cos(2*pi*(<TextBlock Text="{Binding Frequency}"/>*t + <TextBlock Text="{Binding Phase}"/>))
                                </TextBlock>
                            </DataTemplate>

                            <DataTemplate DataType="{x:Type b:RectSignalFunction}">
                                <TextBlock>
                                    <TextBlock Text="{Binding Amplitude}"/>
                                    * Rect(t, tau:<TextBlock Text="{Binding Tau}"/>, T:<TextBlock Text="{Binding Period}"/>)
                                </TextBlock>
                            </DataTemplate>

                            <DataTemplate DataType="{x:Type b:SpaceSignal}">
                                <Border BorderThickness="1" BorderBrush="Blue" CornerRadius="3">
                                    <StackPanel>
                                        <TextBlock Text="{Binding Thetta, StringFormat='Угол {0}'}"/>
                                        <ContentControl Content="{Binding Signal}"/>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </DockPanel.Resources>
                        <Button DockPanel.Dock="Top"  Content="Добавить источник" Command="{Binding AddNewSourceCommand}"/>
                        <ListBox ItemsSource="{Binding Sources}" Name="SourcesList" SelectedIndex="0">
                            <ListBox.ItemContainerStyle>
                                <Style TargetType="ListBoxItem">
                                    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                </Style>
                            </ListBox.ItemContainerStyle>
                        </ListBox>
                    </DockPanel>
                </GroupBox>
            </DockPanel>
        </Grid>
    </DockPanel>
</Window>
